# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/ewm.ipynb.

# %% auto 0
__all__ = ['ewm_mean']

# %% ../nbs/ewm.ipynb 3
import random

import numpy as np
from numba import njit  # type: ignore

from .utils import first_not_na

# %% ../nbs/ewm.ipynb 4
@njit
def ewm_mean(x: np.ndarray, alpha: float) -> np.ndarray:
    n_samples = x.size
    out = np.full_like(x, np.nan)
    start_idx = first_not_na(x)
    if start_idx >= n_samples:
        return out
    out[start_idx] = x[start_idx]
    for i in range(start_idx + 1, n_samples):
        out[i] = alpha * x[i] + (1 - alpha) * out[i - 1]
    return out
